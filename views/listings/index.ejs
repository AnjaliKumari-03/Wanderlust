<% layout("/layouts/boilerplate") %>


<% if (q && q.trim() !== "") { %>
  <p class="text-muted mt-2">
    Showing results for "<strong><%= q %></strong>"
    <% if (selectedCategory) { %>
      in "<strong><%= selectedCategory %></strong>"
    <% } %>
    â€“ <%= listings.length %> stay(s) on this page
  </p>
<% } %>

<div id="filters">
  <!-- ALL -->
  <a href="/listings<%= q ? ('?q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= !selectedCategory ? 'active' : '' %>">
    <div><i class="fa-solid fa-grip"></i></div>
    <p>All</p>
  </a>

  <!-- Each category: keep q -->
  <a href="/listings?category=Trending<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Trending' ? 'active' : '' %>">
      <div><i class="fa-solid fa-fire"></i></div>
      <p>Trending</p>
  </a>

  <a href="/listings?category=Rooms<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Rooms' ? 'active' : '' %>">
      <div><i class="fa-solid fa-bed"></i></div>
      <p>Rooms</p>
  </a>

  <a href="/listings?category=Iconic cities<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Iconic Cities' ? 'active' : '' %>">
      <div><i class="fa-solid fa-mountain-city"></i></div>
      <p>Iconic cities</p>
  </a>

  <a href="/listings?category=Mountains<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Mountains' ? 'active' : '' %>">
      <div><i class="fa-solid fa-mountain"></i></div>
      <p>Mountains</p>
  </a>

  <a href="/listings?category=Castles<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Castles' ? 'active' : '' %>">
      <div><i class="fa-brands fa-fort-awesome"></i></div>
      <p>Castles</p>
  </a>

  <a href="/listings?category=Amazing Pools<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Amazing Pools' ? 'active' : '' %>">
      <div><i class="fa-solid fa-person-swimming"></i></div>
      <p>Amazing Pools</p>
  </a>

  <a href="/listings?category=Camping<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Camping' ? 'active' : '' %>">
      <div><i class="fa-solid fa-campground"></i></div>
      <p>Camping</p>
  </a>

  <a href="/listings?category=Farms<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Farms' ? 'active' : '' %>">
      <div><i class="fa-solid fa-wheat-awn"></i></div>
      <p>Farms</p>
  </a>

  <a href="/listings?category=Arctic<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Arctic' ? 'active' : '' %>">
      <div><i class="fa-solid fa-snowflake"></i></div>
      <p>Arctic</p>
  </a>

  <a href="/listings?category=Domes<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Domes' ? 'active' : '' %>">
      <div><i class="fa-solid fa-landmark-dome"></i></div>
      <p>Domes</p>
  </a>

  <a href="/listings?category=Play<%= q ? ('&q=' + encodeURIComponent(q)) : '' %>" 
     class="filter <%= selectedCategory==='Play' ? 'active' : '' %>">
      <div><i class="fa-solid fa-baseball-bat-ball"></i></div>
      <p>Play</p>
  </a>

  <div class="tax-toggle">
    <div class="form-check-reverse form-switch">
      <input 
        class="form-check-input" 
        type="checkbox" 
        role="switch" 
        id="switchCheckDefault">
      <label class="form-check-label" for="switchCheckDefault">
        Display total after taxes
      </label>
    </div>
  </div>
</div>

<% if (listings.length === 0) { %>
  <p class="text-muted mt-4">No listings match your filters.</p>
<% } else { %>
    <div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3" >
        <% for(let listing of listings) { %>
            <a href="/listings/<%= listing._id %>" class="listing-link">
                <div class="card listing-card col" >
                    <img src="<%= listing.image.url %>" class="card-img-top" alt="listing_image">
                    <div class="card-img-overlay"></div>
                    <div class="card-body">
                        <p class="card-text">
                            <b><%= listing.title %></b> <br>
                            &#8377;<%= listing.price.toLocaleString("en-In") %> / night
                            <i class="tax-info"> &nbsp; + &nbsp; 18% GST</i>
                        </p>
                    </div>
                </div>
            </a>
        <% } %>
    </div>
<% } %>


  
